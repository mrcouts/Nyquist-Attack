#include "Downsample8xClass.h"

Downsample8xClass::Downsample8xClass(int N) //Construtor da classe pai
{
	this->N = N;
	y.zeros(N);

	h = mat("-0.037011176733667  -0.004861913297324  -0.003833440051794  -0.001918238641928   0.000733427210561   0.003853995956054   0.007107662327022   0.010082652982130   0.012364575556955   0.013567818702727   0.013381583718675   0.011647727671889   0.008384072434459   0.003821516187967  -0.001655560832785  -0.007641913014954  -0.013256069080979  -0.017883565055948  -0.020739173772553  -0.021157433579672  -0.018650352120071  -0.012910831441936  -0.003929134221630   0.008035405375639   0.022451291121282   0.038517749982585   0.055240820419681   0.071506679429859   0.086207335320331   0.098314342691984   0.106899716389173   0.111372317647399   0.111372317647399   0.106899716389173   0.098314342691984   0.086207335320331   0.071506679429859   0.055240820419681   0.038517749982585   0.022451291121282   0.008035405375639  -0.003929134221630  -0.012910831441936  -0.018650352120071  -0.021157433579672  -0.020739173772553  -0.017883565055948  -0.013256069080979  -0.007641913014954  -0.001655560832785   0.003821516187967   0.008384072434459   0.011647727671889   0.013381583718675   0.013567818702727   0.012364575556955   0.010082652982130   0.007107662327022   0.003853995956054   0.000733427210561  -0.001918238641928  -0.003833440051794  -0.004861913297324  -0.037011176733667");

	ic.zeros(56);
	u_ic.zeros(8*N+56);
}

Downsample8xClass::~Downsample8xClass()
{
	y.clear();
	h.clear();
	ic.clear();
	u_ic.clear();
}

void Downsample8xClass::Downsample8x(vec *u)
{
	u_ic = join_vert(ic,u[0]);

	for(int i = 0; i < N;i++)
	{
		y.subvec(i,i) = h*u_ic.subvec(8*i,8*i+63);
	}
	ic = u[0].subvec(8*N-56,8*N-1);
}